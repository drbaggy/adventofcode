my%p=map{chomp,my@t=split/:? /;$t[0],@t>2?[@t[1..3]]:$t[1]}<>;
my%f=('+'=>[sub{$_[0]+$_[1]},sub{$_[0]-$_[1]},sub{$_[0]-$_[1]}],
'-'=>[sub{$_[0]-$_[1]},sub{$_[0]+$_[1]},sub{$_[1]-$_[0]}],
'/'=>[sub{$_[0]/$_[1]},sub{$_[0]*$_[1]},sub{$_[1]/$_[0]}],
'*'=>[sub{$_[0]*$_[1]},sub{$_[0]/$_[1]},sub{$_[0]/$_[1]}],1=>[sub{[]}]);
sub j{my($l,$x,$r)=@{$p{$_[0]}};($l,$r)=map{ref$p{$_}?j($_):$p{$_}}$l,$r;
(ref$l||ref$r)?[$l,$x,$r]:$f{$x}[0]($l,$r)}
say j 'root';($p{'humn'},$p{'root'}[1])=([0..2],'-');my$z=j 'root';$_=0;
($_,$z)=($f{$z->[1]}[1+!ref$z->[0]]($_,$z->[2*!ref$z->[2]]),$z->[2*!ref$z->[0]])while$z&&@$z;
say
